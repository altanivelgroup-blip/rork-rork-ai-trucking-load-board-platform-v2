import React, { useMemo, useCallback, useState, memo, useEffect } from 'react';
import { View, Text, StyleSheet, ScrollView, ImageBackground, TouchableOpacity, Switch, TextInput } from 'react-native';
import Screen from '@/src/ui/Screen';
import { theme } from '@/constants/theme';
import { useAuth } from '@/hooks/useAuth';
import { useRouter } from 'expo-router';
import { Truck, Star, Package, ArrowRight, MapPin, Mic, Cloud, Sun, CloudRain, CloudLightning, Snowflake } from 'lucide-react-native';
import { VoiceCapture } from '@/components/VoiceCapture';
import { mockLoads } from '@/mocks/loads';
import { useLoads } from '@/hooks/useLoads';
import { SORT_DROPDOWN_ENABLED, GEO_SORT_ENABLED, AI_RERANK_ENABLED, AI_COPILOT_CHIPS_ENABLED } from '@/constants/flags';
import { SortDropdown } from '@/components/SortDropdown';
import { useSettings, type SortOrder } from '@/hooks/useSettings';
import { useLiveLocation, GeoCoords } from '@/hooks/useLiveLocation';
import { font, moderateScale } from '@/src/ui/scale';
import { trpcClient } from '@/lib/trpc';
import { OPENWEATHER_API_KEY, ORS_API_KEY, MAPBOX_TOKEN } from '@/utils/env';
import { startAudit, endAudit } from '@/utils/performanceAudit';

// Backup of original dashboard before navigation flow implementation